{% extends "structure.html" %}


{% block nav %}
{% if page_no == 1 %}
{% block nav_location %}
{{super()}}
{% endblock nav_location %}
{% else %}
{% endif %}
{% endblock nav %}

{%block main %}
    {% if coming_from_favourites == "true" %}
        {% if can_scroll == true %}
        <div class="row gy-5" style="margin: auto" hx-post="/favourites/{{page_no}}" hx-trigger="revealed" hx-swap="afterend">
        {% else %}
        <div class="row gy-5" style="margin: auto">
        {% endif %}

    {% else %}
            {% if can_scroll == true %}
            <div class="row gy-5" style="margin: auto" hx-post="/{{person_id}}/{{page_no}}" hx-trigger="revealed" hx-swap="afterend">
            {% else %}
            <div class="row gy-5" style="margin: auto">
            {% endif %}
    {% endif %}



    {% for i in range(0, num_posts) %}
    {% if posts[i][0] |length  == 0%} <!--DON'T print the empties-->
    {% else %}
    <div class="col" hx-post="/update_view/{{posts[i][6]}}" hx-trigger="click" hx-target="#view_location{{i}}" hx-swap="innerHTML">
        <div class="card" id="videos">
            <div class="card-header">
                <h1>{{posts[i][0]}}</h1>
                <!--<h1>{{[i]}}</h1>-->
            </div>

            <div>
                <a href="/{{posts[i][5]}}/0">
                    <h3 class=" text-center">
                    {{posts[i][4]}}
                    </h3>
                </a>
                <h5>{{posts[i][1]}}</h5>
            </div>

            <div class="row no-gutters">
                <!--VIDEO-->
                <div class="col-md-4">
                    {{posts[i][2] | safe}}
                </div>

                <div class="col-md-8 text-right">
                  <div class="card-body">
                    <!--LIKES-->
                    <div>
                        {% if posts[i][11] == 0%}
                        <button class="btn btn-outline-dark" hx-post="/update_like/{{posts[i][6]}}" hx-trigger="click" hx-target="#like_location{{i}}" hx-swap="innerHTML" onclick="like_logic(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                              </svg>
                              <div id="like_location{{i}}">
                                {{posts[i][7]}}
                                {{likes}}
                              </div>
                        </button>
                        {% else %}

                        <button class="btn btn-outline-danger" hx-post="/update_like/{{posts[i][6]}}" hx-trigger="click" hx-target="#like_location{{i}}" hx-swap="innerHTML" onclick="like_logic(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"/>
                              </svg>
                              <div id="like_location{{i}}">
                                {{posts[i][7]}}
                                {{likes}}
                              </div>
                        </button>
                        {% endif %}
                    </div>
                    </br>

                    <!-- COMMENTS-->
                    <div>
                        <button class="btn btn-outline-dark" onclick="modal_toggle({{posts[i][6]}})" hx-post="/comment_section/{{posts[i][6]}}/10/likes" hx-trigger="click" hx-target="#comment_section" hx-swap="innerHTML">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-dots-fill" viewBox="0 0 16 16">
                                <path d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM5 8a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm4 0a1 1 0 1 0-2 0 1 1 0 0 0 2 0zm3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
                            </svg>
                            {{posts[i][8]}}
                        </button>
                    </div>
                    </br>

                    <!-- FAVOURITE-->
                    <div>
                        {% if posts[i][12] == 0%}
                        <button class="btn btn-outline-dark" hx-post="/update_fave/{{posts[i][6]}}" hx-trigger="click" hx-target="#fave_location{{i}}" hx-swap="innerHTML" onclick="fave_logic(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
                                <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5V2zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1H4z"/>
                            </svg>
                            
                            <div id="fave_location{{i}}">
                                {{posts[i][9]}}
                                {{faves}}
                            </div>
                        </button>
                        {% else %}

                        <button class="btn btn-outline-danger" hx-post="/update_fave/{{posts[i][6]}}" hx-trigger="click" hx-target="#fave_location{{i}}" hx-swap="innerHTML"  onclick="fave_logic(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bookmark" viewBox="0 0 16 16">
                                <path d="M2 2v13.5a.5.5 0 0 0 .74.439L8 13.069l5.26 2.87A.5.5 0 0 0 14 15.5V2a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2z"/>
                            </svg>
                            <div id="fave_location{{i}}">
                                {{posts[i][9]}}
                                {{faves}}
                            </div>
                        </button>
                        {% endif %}
                    </div>
                    </br>

                    <!-- SEND-->
                    <div>
                        <button class="btn btn-outline-primary">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-send-plus" viewBox="0 0 16 16">
                                <path d="M15.964.686a.5.5 0 0 0-.65-.65L.767 5.855a.75.75 0 0 0-.124 1.329l4.995 3.178 1.531 2.406a.5.5 0 0 0 .844-.536L6.637 10.07l7.494-7.494-1.895 4.738a.5.5 0 1 0 .928.372l2.8-7Zm-2.54 1.183L5.93 9.363 1.591 6.602l11.833-4.733Z"/>
                                <path d="M16 12.5a3.5 3.5 0 1 1-7 0 3.5 3.5 0 0 1 7 0Zm-3.5-2a.5.5 0 0 0-.5.5v1h-1a.5.5 0 0 0 0 1h1v1a.5.5 0 0 0 1 0v-1h1a.5.5 0 0 0 0-1h-1v-1a.5.5 0 0 0-.5-.5Z"/>
                              </svg>
                        </button>
                    </div>
                    
                    </br>

                  </div>
                </div>
              </div>
            
            <div class=" card-footer">
                <small class="text-muted">
                    <!--VIEWS-->
                    <span>
                        <button class="btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye" viewBox="0 0 16 16">
                                <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
                                <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
                            </svg>
                            <span id="view_location{{i}}">
                                {{posts[i][10]}}
                                {{views}}
                            </span>
                        </button>

                    </span>

                    <!--UPLOAD DATE-->
                    <span class="float-right">{{posts[i][3]}}</span>
                </small>
            </div>
        </div>   
    </div>

    {% endif %}
    {% endfor %}

</div>
<!--
<div id="footer_location">
    {% block footer %}
    {% if page_no == 1 %}
    {{super()}}
    {% endif %}
    {% endblock footer %}
</div>
-->

<!-- COMMENT SECTION MODAL  -->
<div  id="comment_modal" class="modal">
    <div class="modal-dialog" role="document">
        <div class="modal-content">

            <div id="comment_section">
            </div>

        </div>
    </div>
</div>
<!-- COMMENT  -->

<script>

function like_logic(value){
    console.log(value)
    if ( $(value).hasClass("btn btn-outline-danger")){
        $(value).removeClass("btn btn-outline-danger");
        $(value).addClass("btn btn-outline-dark");  
    }
    else{
        $(value).removeClass("btn btn-outline-dark");
        $(value).addClass("btn btn-outline-danger");  
    }
}

function fave_logic(value){
    console.log(value)
    if ( $(value).hasClass("btn btn-outline-danger")){
        $(value).removeClass("btn btn-outline-danger");
        $(value).addClass("btn btn-outline-dark");  
    }
    else{
        $(value).removeClass("btn btn-outline-dark");
        $(value).addClass("btn btn-outline-danger");  
    }
}

function modal_toggle(post_id){
    console.log('hello')
    console.log('post id', post_id)
    document.getElementById("comment_modal").style.display = "block"
}

window.onclick = function (event) {
    var modal = document.getElementById("comment_modal");
    if (event.target == modal){
        if (modal != null){
            modal.style.display = "none";
        }
    }
}






</script>
{% endblock main %}
